{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.search-form');\nconst list = document.querySelector('.pictures-list');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.button-load');\n\nconst lightbox = new SimpleLightbox('.gallery-card a.gallary-card-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet search = null;\nlet totalResult = 0;\nlet page = 1;\nconst perPage = 15;\n\nfunction toggleLoader(show, isLoadMore = false) {\n  if (isLoadMore) {\n    loadBtn.style.display = show ? 'none' : 'flex';\n  }\n  loader.style.display = show ? 'flex' : 'none';\n}\n\nfunction toggleLoadBtn(show) {\n  loadBtn.disabled = !show;\n  loadBtn.style.display = show ? 'flex' : 'none';\n  loadBtn.style.opacity = show ? 1 : 0;\n  loadBtn.style.overflow = show ? 'visible' : 'hidden';\n}\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  let searchImg = e.target.elements.input.value.trim();\n  search = searchImg;\n  page = 1;\n\n  if (search === '') {\n    iziToast.warning({\n      message: 'Please enter a search term.',\n      position: 'topRight',\n      backgroundColor: '#add8e6',\n      messageColor: 'white',\n    });\n    return;\n  }\n\n  toggleLoader(true);\n\n  if (lightbox) {\n    lightbox.close();\n    list.innerHTML = '';\n  }\n\n  try {\n    const data = await getImg();\n    totalResult = data.totalHits;\n    render(data.hits);\n    lightbox.refresh();\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message: 'Sorry, no images match your search query. Please try again!',\n        position: 'topRight',\n        backgroundColor: 'red',\n        messageColor: 'white',\n      });\n      toggleLoadBtn(false);\n    } else {\n      checkLastPage();\n    }\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occurred while fetching images. Please try again later.',\n      position: 'topRight',\n      backgroundColor: 'red',\n      messageColor: 'white',\n    });\n    toggleLoadBtn(false);\n  } finally {\n    toggleLoader(false);\n  }\n\n  e.target.reset();\n});\n\n// Кнопка Load More\nloadBtn.addEventListener('click', async () => {\n  page += 1;\n  toggleLoader(true, true);\n\n  try {\n    const data = await getImg();\n    render(data.hits);\n    lightbox.refresh();\n    checkLastPage();\n\n    const galleryCards = document.querySelectorAll('.gallery-card');\n    galleryCards.forEach(card => {\n      const cardSize = card.getBoundingClientRect();\n      window.scrollBy({\n        top: cardSize.height * 1.36,\n        behavior: 'smooth',\n      });\n    });\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occurred while fetching more images. Please try again later.',\n      position: 'topRight',\n      backgroundColor: 'red',\n      messageColor: 'white',\n    });\n    toggleLoadBtn(false);\n  } finally {\n    toggleLoader(false, true);\n  }\n});\n\nfunction checkLastPage() {\n  const maxPage = Math.ceil(totalResult / perPage);\n  if (page >= maxPage) {\n    iziToast.warning({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n      backgroundColor: '#add8e6',\n      messageColor: 'white',\n    });\n    toggleLoadBtn(false);\n  } else {\n    toggleLoadBtn(true);\n  }\n}\n\nasync function getImg() {\n  const API_KEY = '42193842-675e74ed987999787d4b57f5e';\n\n  const params = new URLSearchParams({\n    key: API_KEY,\n    per_page: perPage,\n    page: page,\n    q: search,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  });\n\n  try {\n    const response = await axios.get(`https://pixabay.com/api/?${params}`);\n    return response.data;\n  } catch (error) {\n    throw new Error('Error fetching data from API');\n  }\n}\n\nfunction render(imgs) {\n  const markup = imgs\n    .map(img => {\n      return `<li class=\"gallery-card\">\n    <a class=\"gallary-card-link\" href=\"${img.largeImageURL}\">\n        <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" />\n    <ul class=\"image-info\">\n            <li class=\"image-item-info\">\n            <p>Likes</p>\n            <p>${img.likes}</p>\n        </li>\n        <li class=\"image-item-info\">\n            <p>Views</p>\n            <p>${img.views}</p>\n        </li>\n        <li class=\"image-item-info\">\n            <p>Comments</p>\n            <p>${img.comments}</p>\n        </li>\n        <li class=\"image-item-info\">\n            <p>Downloads</p>\n            <p>${img.downloads}</p>\n        </li>\n    </ul>\n    </a>\n</li>`;\n    })\n    .join('');\n\n  list.insertAdjacentHTML('beforeend', markup);\n}\n"],"names":["form","list","loader","loadBtn","lightbox","SimpleLightbox","search","totalResult","page","perPage","toggleLoader","show","isLoadMore","toggleLoadBtn","iziToast","data","getImg","render","checkLastPage","card","cardSize","maxPage","API_KEY","params","axios","imgs","markup","img"],"mappings":"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"}